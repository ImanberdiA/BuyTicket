<!DOCTYPE html>
<html lang="en">
<head>
    <title>IMANBERDI</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
</head>
<body>
<nav class="navbar navbar-inverse">
    <div class="container-fluid">
        <div class="navbar-header">
            <a class="navbar-brand" href="http://localhost:1003">Music Player</a>
        </div>
        <ul class="nav navbar-nav">
            <li class="active"><a href="http://localhost:1003">Home</a></li>
            <li><a href="http://localhost:1003/users">Пользователи</a></li>
            <li><a href="http://localhost:1003/contents">Контенты</a></li>
            <li><a href="http://localhost:1003/playlists">Плейлисты</a></li>
        </ul>
    </div>
</nav>
<div class="container">
    <!--<h2>Striped Rows</h2>-->
    <!--<p>The .table-striped class adds zebra-stripes to a table:</p>-->
    <table class="w3-table w3-striped w3-border">
        <tbody>
        <tr class="w3-green">
            <th>ID</th>
            <th>Логин</th>
            <th>Имя</th>
            <th>Фамилия</th>
        </tr>
        {{#each userObject}}
            <tr><td>{{this.id}}</td> <td>{{this.Login}}</td> <td>{{this.FirstName}}</td> <td>{{this.LastName}}</td></tr>
        {{/each}}
        </tbody>
    </table>
    <h1>{{mess}}</h1>
</div>


<script>
    function updateUser(id, Login, Password, FirstName, LastName) {
        $.put = function(url, data, callback, type){
            if ( $.isFunction(data) ){
                type = type || callback,
                        callback = data,
                        data = {}
            }
            return $.ajax({
                url: url,
                type: 'PUT',
                success: callback,
                data: data,
                contentType: type
            });
        }
        $.put('http://localhost:1003/users/' + id, {Login: Login, Password: Password, FirstName: FirstName, LastName: LastName }, function (result) {
            console.log(result);
        })
    }
    function deleteUser(id, Login, Password, FirstName, LastName) {
        jQuery.each( [ "put", "delete" ], function( i, method ) {
            jQuery[ method ] = function( url, data, callback, type ) {
                if ( jQuery.isFunction( data ) ) {
                    type = type || callback;
                    callback = data;
                    data = undefined;
                }
                return jQuery.ajax({
                    url: url,
                    type: method,
                    headers: {'Authorization': 'Bearer 791600822376353450b9d3271bdf086e7f28086d93170821609b20e879d4d40f'},
                    dataType: type,
                    data: data,
                    success: callback
                });
            };
        });
        $.delete('http://localhost:1003/users/' + id, function(result){
            console.log(result);
        })
    }
</script>


<div class="container">
    <form id='forma' class="w3-container w3-card-4 w3-light-grey w3-text-blue w3-margin">
        <div class="w3-panel w3-green w3-round-xlarge">
            <h5>Изменить данные определенного пользователяя</h5>
        </div>
        <div class="form-row">
            <div class="form-group col-md-4">
                <label for="id">ID пользователя</label>
                <input type="text" class="form-control" id="id" placeholder="id..." name="id" required pattern="[0-9]+$">
            </div>
            <div class="form-group col-md-4">
                <label for="Login">Логин</label>
                <input type="text" class="form-control" id="Login" placeholder="Логин..." name="Login">
            </div>
            <div class="form-group col-md-4">
                <label for="Password">Пароль</label>
                <input type="text" class="form-control" id="Password" placeholder="Пароль..." name="Password">
            </div>
            <div class="form-group col-md-6">
                <label for="FirstName">Имя</label>
                <input type="text" class="form-control" id="FirstName" placeholder="Имя..." name="FirstName">
            </div>
            <div class="form-group col-md-6">
                <label for="LastName">Фамилия</label>
                <input type="text" class="form-control" id="LastName" placeholder="Фамилия..." name="LastName">
            </div>
            <div>
                <input type="submit" class="w3-button w3-block w3-section w3-green w3-ripple w3-padding" onclick='updateUser(document.forms["forma"].elements["id"].value, document.forms["forma"].elements["Login"].value, document.forms["forma"].elements["Password"].value, document.forms["forma"].elements["FirstName"].value, document.forms["forma"].elements["LastName"].value)' value="Изменить"/>
            </div>
        </div>
    </form>
</div>

<div class="container">
    <form id='formaDel' class="w3-container w3-card-4 w3-light-grey w3-text-blue w3-margin">
        <div class="w3-panel w3-red w3-round-xlarge">
            <h5>Удалить пользователя</h5>
        </div>
        <div class="form-row">
            <div class="form-group col-md-4">
                <label for="id">ID пользователя</label>
                <input type="text" class="form-control" id="id" placeholder="id..." name="id" required pattern="[ 0-9]+$">
            </div>
            <div class="form-group col-md-4">
                <input type="submit" class="w3-button w3-block w3-section w3-red w3-ripple w3-padding" onclick='deleteUser(document.forms["formaDel"].elements["id"].value)' value="Удалить пользователя"/>
            </div>
        </div>
    </form>
</div>


<div class="container">
    <form method="POST" action="/users" id='formaDel' class="w3-container w3-card-4 w3-light-grey w3-text-blue w3-margin">
        <!--<form method="POST" action="/users/new">-->
        <div class="w3-panel w3-green w3-round-xlarge">
            <h5>Создать пользователя</h5>
        </div>
        <div class="form-row">
            <div class="form-group col-md-4">
                <label for="Login">Логин</label>
                <input type="text" class="form-control" id="Login" placeholder="Логин..." name="Login">
            </div>
            <div class="form-group col-md-4">
                <label for="Password">Пароль</label>
                <input type="text" class="form-control" id="Password" placeholder="Пароль..." name="Password">
            </div>
            <div class="form-group col-md-4">
                <label for="FirstName">Имя</label>
                <input type="text" class="form-control" id="FirstName" placeholder="Имя..." name="FirstName">
            </div>
            <div class="form-group col-md-4">
                <label for="LastName">Фамилия</label>
                <input type="text" class="form-control" id="LastName" placeholder="Фамилия..." name="LastName">
            </div>
            <!--<input type="submit" value="Создать пользователя">-->
        </div>
        <input type="submit" class="w3-button w3-block w3-section w3-green w3-ripple w3-padding" value="Создать пользователя"/>
    </form>
</div>


<div class="container">
    <form method="POST" action="/users/playlists" id='formaDel' class="w3-container w3-card-4 w3-light-grey w3-text-blue w3-margin">
        <!--<form method="POST" action="/users/new">-->
        <div class="w3-panel w3-green w3-round-xlarge">
            <h5>Создать пользователя с заранее известным плейлистом (4 пункт)</h5>
        </div>
        <div class="form-row">
            <div class="form-group col-md-4">
                <label for="Login">Логин</label>
                <input type="text" class="form-control" id="Login" placeholder="Логин..." name="Login">
            </div>
            <div class="form-group col-md-4">
                <label for="Password">Пароль</label>
                <input type="text" class="form-control" id="Password" placeholder="Пароль..." name="Password">
            </div>
            <div class="form-group col-md-4">
                <label for="FirstName">Имя</label>
                <input type="text" class="form-control" id="FirstName" placeholder="Имя..." name="FirstName">
            </div>
            <div class="form-group col-md-4">
                <label for="LastName">Фамилия</label>
                <input type="text" class="form-control" id="LastName" placeholder="Фамилия..." name="LastName">
            </div>
            <div class="form-group col-md-4">
                <label for="pid">Название плейлиста пользователя</label>
                <input type="text" class="form-control" id="pid" placeholder="Плейлист пользователя..." name="pid">
            </div>
            <!--<input type="submit" value="Создать пользователя">-->
        </div>
        <input type="submit" class="w3-button w3-block w3-section w3-green w3-ripple w3-padding" value="Создать пользователя с плейлистом"/>
    </form>
    <h2>{{messUser}}</h2>
</div>

<div class="container">
    <form method="POST" action="/users/:id/contents" id='formaDel' class="w3-container w3-card-4 w3-light-grey w3-text-blue w3-margin">
        <!--<form method="POST" action="/users/new">-->
        <div class="w3-panel w3-green w3-round-xlarge">
            <h5>Агрегирующий запрос</h5>
        </div>
        <div class="form-row">
            <div class="form-group col-md-4">
                <label for="id">ID пользователя</label>
                <input type="text" class="form-control" id="id" placeholder="ID пользователя..." name="id">
            </div>
            <!--<input type="submit" value="Создать пользователя">-->
        </div>
        <input type="submit" class="w3-button w3-block w3-section w3-green w3-ripple w3-padding" value="Получить контент этого пользователя"/>
    </form>
    <h1> {{messAgr}}{{id}} {{agrObject}} </h1>
</div>
</body>
</html>